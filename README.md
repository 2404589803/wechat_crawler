# 微信公众号文章爬虫

这是一个功能强大的微信公众号文章爬虫工具，可以爬取微信公众号文章内容，包括文本、图片和视频，并保存为多种格式。

## 主要功能

- **文章爬取**：支持爬取微信公众号文章的全部内容，包括标题、作者、发布时间和正文
- **媒体下载**：可下载文章中的图片和视频内容
- **多种输出格式**：支持保存为JSON、文本、HTML和Markdown格式
- **批量处理**：一次处理多篇文章，自动生成汇总报告
- **代理支持**：可配置代理服务器，避免IP限制
- **错误重试**：内置请求失败自动重试机制，提高爬取成功率
- **用户界面**：提供友好的图形界面，方便操作

## 安装

### 基础依赖

```bash
pip install requests beautifulsoup4 gradio
```

### 视频下载（可选）

如果需要下载视频文件，需要安装yt-dlp：

```bash
pip install yt-dlp
```

## 使用方法

### GUI界面

运行以下命令启动图形界面：

```bash
python wechat_article_ui.py
```

打开浏览器，访问显示的本地URL（通常是 http://127.0.0.1:7860）。

### 命令行接口

你也可以使用命令行模式：

```bash
# 单篇文章爬取
python wechat_article_crawler.py -u <微信文章URL> -o <输出文件名> -d <输出目录> -m -v

# 批量爬取
python wechat_article_crawler.py -f <包含多个URL的文件> -b -d <输出目录> -m -v
```

参数说明：
- `-u, --url`: 微信文章URL
- `-f, --file`: 包含多个URL的文件，每行一个URL
- `-b, --batch`: 批量模式处理多个URL
- `-o, --output`: 输出文件名 (默认: article_content.json)
- `-d, --output_dir`: 输出文件保存文件夹 (默认: outputs)
- `-t, --text`: 同时生成纯文本文件
- `-html, --html`: 同时生成HTML文件
- `-md, --markdown`: 同时生成Markdown文件
- `-m, --media`: 下载文章中的图片和视频
- `-v, --video`: 尝试下载视频文件 (需要安装 yt-dlp)
- `-p, --proxy`: 使用代理服务器 (格式: http://127.0.0.1:7890)
- `-r, --retry`: 请求失败重试次数 (默认: 3)
- `--timeout`: 请求超时时间(秒) (默认: 10)

## 主要功能说明

### 单篇爬取

在"单篇爬取"页面，输入微信公众号文章链接，选择输出格式和下载选项，点击"开始爬取"按钮即可。

### 批量爬取

在"批量爬取"页面，输入多个微信公众号文章链接（每行一个），设置输出选项，点击"开始批量爬取"按钮。

系统会：
1. 创建批处理文件夹，包含时间戳
2. 为每篇文章创建单独的子文件夹
3. 生成汇总报告，记录成功和失败的文章
4. 自动跳过处理失败的文章，继续处理其他文章

### 配置设置

在"设置"页面，可以配置以下选项：
- 输出目录
- 媒体文件夹名称
- 全局代理服务器
- 请求超时时间
- 请求重试次数

配置会保存在`config.json`文件中，程序重启后仍然有效。

## 目录结构

爬取结果将按以下结构保存：

```
outputs/
  ├── article_20240326_123456/              # 单篇文章文件夹
  │   ├── article_content_20240326_123456.json  # 文章JSON输出
  │   ├── article_content_20240326_123456.txt   # 文章文本输出
  │   ├── article_content_20240326_123456.html  # 文章HTML输出
  │   ├── article_content_20240326_123456.md    # 文章Markdown输出
  │   └── media/                            # 媒体文件夹
  │       ├── 文章标题_img_1.jpg             # 图片文件
  │       └── 文章标题_video_1.mp4           # 视频文件
  │
  └── batch_20240326_123456/               # 批量处理文件夹
      ├── batch_summary.md                 # 批处理汇总报告
      ├── article_001/                     # 第一篇文章文件夹
      │   ├── article_001.json            # 文章JSON输出
      │   ├── article_001.txt             # 文章文本输出
      │   ├── article_001.html            # 文章HTML输出
      │   ├── article_001.md              # 文章Markdown输出
      │   └── media/                      # 文章媒体文件夹
      │       ├── article_001_img_1.jpg   # 图片文件
      │       └── article_001_video_1.mp4 # 视频文件
      │
      └── article_002/                     # 第二篇文章文件夹
          └── ...                         # 同上
```

## 注意事项

1. 链接有效期：微信文章链接通常有有效期限制，请尽快爬取分享的链接
2. 视频下载：部分视频可能无法下载，系统会提供多个备选链接
3. 代理设置：如果频繁爬取，建议配置代理服务器以避免IP限制
4. 合理使用：请遵守相关法律法规，不要用于非法用途

## 许可证

本项目采用 MIT 许可证。详情请参阅 [LICENSE](LICENSE) 文件。

MIT 许可证是一种宽松的软件许可证，只要用户在软件的所有副本中都包含原始许可证声明，就可以自由地使用、修改、共享、销售本软件。

本项目仅用于学习和研究，请勿用于非法用途。在使用本工具时，请遵守相关法律法规，合法合规地获取和使用内容。 